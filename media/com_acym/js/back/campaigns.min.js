jQuery(document).ready(function(e){e("#launch_spamtest").off("click").on("click",function(){if(e(this).hasClass("acym_icon_disabled"))return!1;e(this).addClass("acym_icon_disabled"),e(".acym_icon_container").find("i").removeClass().html("").addClass("acymicon-circle-o-notch acymicon-spin"),e(".acym_check_results").hide().html(""),e("#acym_spam_test_details").addClass("is-hidden"),e("#safe_check_results").removeClass("is-hidden"),c("Content","check_words","checkContent"),c("Links","check_links","checkLinks"),c("SPAM","check_spam","checkSPAM")}),e("#acym_spam_test_details button").off("click").on("click",function(){e("#check_spam").click()}),e(".campaigns_tests").length>0&&(acym_helperIntroJS.introContent=[{element:"#spam_test_zone",text:ACYM_JS_TXT.ACYM_INTRO_SAFE_CHECK,position:"right"}],acym_helperIntroJS.setIntrojs("campaigns_tests")),e("#acym__campaign__send-test").off("click").on("click",function(){e("#acym__campaigns__send-test__spinner").show();var a=e(this);a.attr("disabled","true");var c=ACYM_AJAX_URL+"&page=acymailing_campaigns&ctrl=campaigns&task=test&id="+e('input[name="id"]').val()+"&test_note="+encodeURIComponent(jQuery("#acym__wysid__send__test__note").val())+"&test_emails="+encodeURIComponent(e(".acym__multiselect__email").val().join(","));e.post(c,function(c){a.removeAttr("disabled"),e("#acym__campaigns__send-test__spinner").hide(),c=JSON.parse(c),acym_helperNotification.addNotification(c.message,c.type)})}),function(){let a=e('[name="acym_triggers"]');a.on("change",function(){e(".acym__campaign__sendsettings__params__one").hide(),e('[data-trigger-show="'+e(this).val()+'"]').show(),e(".acym__campaign__sendsettings__params__one select").select2({theme:"foundation",width:"100%"})}),a.trigger("change")}(),e(".acym__campaign__summary__generated__mail__toogle__preview").off("click").on("click",function(){let a=e("#acym__wysid__email__preview");a.hasClass("acym__wysid__email__preview__extend")?a.removeClass("acym__wysid__email__preview__extend"):a.addClass("acym__wysid__email__preview__extend")}),acym_helperDynamic.setModalDynamics(),acym_helperEditorHtml.initEditorHtml(),acym_helperEditorWysid.initEditor(),acym_helperCampaigns.initCampaigns(),e(".acym__campaign__sendsettings__params__one select").addClass("shrink");let a=0;function c(c,s,t){let _=e('input[name="id"]').val(),i=e("#"+s).removeClass("acym_clickable").off("click"),n=i.find(".acym_icon_container i");e.ajax({url:ACYM_AJAX_URL+"&ctrl=campaigns&task="+t+"&id="+_,success:function(s){if("SPAM"==c){let a=e.parseJSON(s);if("success"==a.type){i.next(".acym_check_results").html(ACYM_JS_TXT.ACYM_TESTS_SPAM_SENT).show();let c=0,s=setInterval(function(){c++,e.getJSON(a.message+"&format=json",function(t){0!=t.status?(clearInterval(s),i.next(".acym_check_results").hide(),e("#acym_spam_test_details").removeClass("is-hidden"),t.mark>-2?n.removeClass().addClass("acymicon-check-circle acym_icon_green"):n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),i.attr("data-open")||i.attr("data-open",i.attr("data-iframe")),i.addClass("acym_clickable").attr("data-iframe",a.message+"&lang="+a.lang),acym_helperModal.initModal()):c>5&&(i.next(".acym_check_results").html(t.title),i.addClass("acym_clickable").on("click",function(){e(this).next(".acym_check_results").slideToggle()}),n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),clearInterval(s))})},1e4)}else i.next(".acym_check_results").html(a.message),i.addClass("acym_clickable").on("click",function(){e(this).next(".acym_check_results").slideToggle()}),n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red")}else s?(n.removeClass().addClass("acymicon-exclamation-circle acym_icon_red"),i.addClass("acym_clickable").on("click",function(){e(this).next(".acym_check_results").slideToggle()}),i.next(".acym_check_results").html(s)):n.removeClass().addClass("acymicon-check-circle acym_icon_green");3==++a&&(a=0,e("#launch_spamtest").removeClass("acym_icon_disabled"))}})}});